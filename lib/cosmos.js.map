{"version":3,"file":"cosmos.js","sources":["webpack://cosmos-js/cosmos.js"],"sourcesContent":["!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(\"cosmos-js\",[],t):\"object\"==typeof exports?exports[\"cosmos-js\"]=t():e[\"cosmos-js\"]=t()}(global,function(){return function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,\"a\",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p=\"\",o(o.s=6)}([function(e,t){e.exports=require(\"stream\")},function(e,t,o){var n=o(7),r=n.default||n,s=function(e,t){return/^\\/\\//.test(e)&&(e=\"https:\"+e),r.call(this,e,t)};e.exports=t=s,t.fetch=s,t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response,t.default=s},function(e,t){e.exports=require(\"zlib\")},function(e,t){e.exports=require(\"url\")},function(e,t){e.exports=require(\"http\")},function(e,t){e.exports=require(\"https\")},function(e,t,o){e.exports=o(8)},function(e,t,o){\"use strict\";o.r(t),o.d(t,\"Headers\",function(){return _}),o.d(t,\"Request\",function(){return H}),o.d(t,\"Response\",function(){return D}),o.d(t,\"FetchError\",function(){return f});var n=o(0),r=o(4),s=o(3),i=o(5),a=o(2);const u=n.Readable,c=Symbol(\"buffer\"),l=Symbol(\"type\");class d{constructor(){this[l]=\"\";const e=arguments[0],t=arguments[1],o=[];let n=0;if(e){const t=e,r=Number(t.length);for(let e=0;e<r;e++){const r=t[e];let s;n+=(s=r instanceof Buffer?r:ArrayBuffer.isView(r)?Buffer.from(r.buffer,r.byteOffset,r.byteLength):r instanceof ArrayBuffer?Buffer.from(r):r instanceof d?r[c]:Buffer.from(\"string\"==typeof r?r:String(r))).length,o.push(s)}}this[c]=Buffer.concat(o);let r=t&&void 0!==t.type&&String(t.type).toLowerCase();r&&!/[^\\u0020-\\u007E]/.test(r)&&(this[l]=r)}get size(){return this[c].length}get type(){return this[l]}text(){return Promise.resolve(this[c].toString())}arrayBuffer(){const e=this[c],t=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return Promise.resolve(t)}stream(){const e=new u;return e._read=function(){},e.push(this[c]),e.push(null),e}toString(){return\"[object Blob]\"}slice(){const e=this.size,t=arguments[0],o=arguments[1];let n,r;n=void 0===t?0:t<0?Math.max(e+t,0):Math.min(t,e),r=void 0===o?e:o<0?Math.max(e+o,0):Math.min(o,e);const s=Math.max(r-n,0),i=this[c].slice(n,n+s),a=new d([],{type:arguments[2]});return a[c]=i,a}}function f(e,t,o){Error.call(this,e),this.message=e,this.type=t,o&&(this.code=this.errno=o.code),Error.captureStackTrace(this,this.constructor)}let g;Object.defineProperties(d.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty(d.prototype,Symbol.toStringTag,{value:\"Blob\",writable:!1,enumerable:!1,configurable:!0}),f.prototype=Object.create(Error.prototype),f.prototype.constructor=f,f.prototype.name=\"FetchError\";try{g=require(\"encoding\").convert}catch(e){}const p=Symbol(\"Body internals\"),m=n.PassThrough;function h(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.size;let s=void 0===r?0:r;var i=o.timeout;let a=void 0===i?0:i;null==e?e=null:y(e)?e=Buffer.from(e.toString()):v(e)||Buffer.isBuffer(e)||(\"[object ArrayBuffer]\"===Object.prototype.toString.call(e)?e=Buffer.from(e):ArrayBuffer.isView(e)?e=Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof n||(e=Buffer.from(String(e)))),this[p]={body:e,disturbed:!1,error:null},this.size=s,this.timeout=a,e instanceof n&&e.on(\"error\",function(e){const o=\"AbortError\"===e.name?e:new f(`Invalid response body while trying to fetch ${t.url}: ${e.message}`,\"system\",e);t[p].error=o})}function b(){var e=this;if(this[p].disturbed)return h.Promise.reject(new TypeError(`body used already for: ${this.url}`));if(this[p].disturbed=!0,this[p].error)return h.Promise.reject(this[p].error);let t=this.body;if(null===t)return h.Promise.resolve(Buffer.alloc(0));if(v(t)&&(t=t.stream()),Buffer.isBuffer(t))return h.Promise.resolve(t);if(!(t instanceof n))return h.Promise.resolve(Buffer.alloc(0));let o=[],r=0,s=!1;return new h.Promise(function(n,i){let a;e.timeout&&(a=setTimeout(function(){s=!0,i(new f(`Response timeout while trying to fetch ${e.url} (over ${e.timeout}ms)`,\"body-timeout\"))},e.timeout)),t.on(\"error\",function(t){\"AbortError\"===t.name?(s=!0,i(t)):i(new f(`Invalid response body while trying to fetch ${e.url}: ${t.message}`,\"system\",t))}),t.on(\"data\",function(t){if(!s&&null!==t){if(e.size&&r+t.length>e.size)return s=!0,void i(new f(`content size at ${e.url} over limit: ${e.size}`,\"max-size\"));r+=t.length,o.push(t)}}),t.on(\"end\",function(){if(!s){clearTimeout(a);try{n(Buffer.concat(o,r))}catch(t){i(new f(`Could not create Buffer from response body for ${e.url}: ${t.message}`,\"system\",t))}}})})}function y(e){return\"object\"==typeof e&&\"function\"==typeof e.append&&\"function\"==typeof e.delete&&\"function\"==typeof e.get&&\"function\"==typeof e.getAll&&\"function\"==typeof e.has&&\"function\"==typeof e.set&&(\"URLSearchParams\"===e.constructor.name||\"[object URLSearchParams]\"===Object.prototype.toString.call(e)||\"function\"==typeof e.sort)}function v(e){return\"object\"==typeof e&&\"function\"==typeof e.arrayBuffer&&\"string\"==typeof e.type&&\"function\"==typeof e.stream&&\"function\"==typeof e.constructor&&\"string\"==typeof e.constructor.name&&/^(Blob|File)$/.test(e.constructor.name)&&/^(Blob|File)$/.test(e[Symbol.toStringTag])}function w(e){let t,o,r=e.body;if(e.bodyUsed)throw new Error(\"cannot clone body after it is used\");return r instanceof n&&\"function\"!=typeof r.getBoundary&&(t=new m,o=new m,r.pipe(t),r.pipe(o),e[p].body=t,r=o),r}function x(e){return null===e?null:\"string\"==typeof e?\"text/plain;charset=UTF-8\":y(e)?\"application/x-www-form-urlencoded;charset=UTF-8\":v(e)?e.type||null:Buffer.isBuffer(e)?null:\"[object ArrayBuffer]\"===Object.prototype.toString.call(e)?null:ArrayBuffer.isView(e)?null:\"function\"==typeof e.getBoundary?`multipart/form-data;boundary=${e.getBoundary()}`:e instanceof n?null:\"text/plain;charset=UTF-8\"}function S(e){const t=e.body;return null===t?0:v(t)?t.size:Buffer.isBuffer(t)?t.length:t&&\"function\"==typeof t.getLengthSync&&(t._lengthRetrievers&&0==t._lengthRetrievers.length||t.hasKnownLength&&t.hasKnownLength())?t.getLengthSync():null}h.prototype={get body(){return this[p].body},get bodyUsed(){return this[p].disturbed},arrayBuffer(){return b.call(this).then(function(e){return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)})},blob(){let e=this.headers&&this.headers.get(\"content-type\")||\"\";return b.call(this).then(function(t){return Object.assign(new d([],{type:e.toLowerCase()}),{[c]:t})})},json(){var e=this;return b.call(this).then(function(t){try{return JSON.parse(t.toString())}catch(t){return h.Promise.reject(new f(`invalid json response body at ${e.url} reason: ${t.message}`,\"invalid-json\"))}})},text(){return b.call(this).then(function(e){return e.toString()})},buffer(){return b.call(this)},textConverted(){var e=this;return b.call(this).then(function(t){return function(e,t){if(\"function\"!=typeof g)throw new Error(\"The package `encoding` must be installed to use the textConverted() function\");const o=t.get(\"content-type\");let n,r,s=\"utf-8\";o&&(n=/charset=([^;]*)/i.exec(o));r=e.slice(0,1024).toString(),!n&&r&&(n=/<meta.+?charset=(['\"])(.+?)\\1/i.exec(r));!n&&r&&(n=/<meta[\\s]+?http-equiv=(['\"])content-type\\1[\\s]+?content=(['\"])(.+?)\\2/i.exec(r))&&(n=/charset=(.*)/i.exec(n.pop()));!n&&r&&(n=/<\\?xml.+?encoding=(['\"])(.+?)\\1/i.exec(r));n&&(\"gb2312\"!==(s=n.pop())&&\"gbk\"!==s||(s=\"gb18030\"));return g(e,\"UTF-8\",s).toString()}(t,e.headers)})}},Object.defineProperties(h.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),h.mixIn=function(e){for(const t of Object.getOwnPropertyNames(h.prototype))if(!(t in e)){const o=Object.getOwnPropertyDescriptor(h.prototype,t);Object.defineProperty(e,t,o)}},h.Promise=global.Promise;const $=/[^\\^_`a-zA-Z\\-0-9!#$%&'*+.|~]/,P=/[^\\t\\x20-\\x7e\\x80-\\xff]/;function T(e){if(e=`${e}`,$.test(e)||\"\"===e)throw new TypeError(`${e} is not a legal HTTP header name`)}function j(e){if(e=`${e}`,P.test(e))throw new TypeError(`${e} is not a legal HTTP header value`)}function k(e,t){t=t.toLowerCase();for(const o in e)if(o.toLowerCase()===t)return o}const O=Symbol(\"map\");class _{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(this[O]=Object.create(null),e instanceof _){const t=e.raw(),o=Object.keys(t);for(const e of o)for(const o of t[e])this.append(e,o)}else if(null==e);else{if(\"object\"!=typeof e)throw new TypeError(\"Provided initializer must be an object\");{const t=e[Symbol.iterator];if(null!=t){if(\"function\"!=typeof t)throw new TypeError(\"Header pairs must be iterable\");const o=[];for(const t of e){if(\"object\"!=typeof t||\"function\"!=typeof t[Symbol.iterator])throw new TypeError(\"Each header pair must be iterable\");o.push(Array.from(t))}for(const e of o){if(2!==e.length)throw new TypeError(\"Each header pair must be a name/value tuple\");this.append(e[0],e[1])}}else for(const t of Object.keys(e)){const o=e[t];this.append(t,o)}}}}get(e){T(e=`${e}`);const t=k(this[O],e);return void 0===t?null:this[O][t].join(\", \")}forEach(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=E(this),n=0;for(;n<o.length;){var r=o[n];const s=r[0],i=r[1];e.call(t,i,s,this),o=E(this),n++}}set(e,t){t=`${t}`,T(e=`${e}`),j(t);const o=k(this[O],e);this[O][void 0!==o?o:e]=[t]}append(e,t){t=`${t}`,T(e=`${e}`),j(t);const o=k(this[O],e);void 0!==o?this[O][o].push(t):this[O][e]=[t]}has(e){return T(e=`${e}`),void 0!==k(this[O],e)}delete(e){T(e=`${e}`);const t=k(this[O],e);void 0!==t&&delete this[O][t]}raw(){return this[O]}keys(){return A(this,\"key\")}values(){return A(this,\"value\")}[Symbol.iterator](){return A(this,\"key+value\")}}function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:\"key+value\";return Object.keys(e[O]).sort().map(\"key\"===t?function(e){return e.toLowerCase()}:\"value\"===t?function(t){return e[O][t].join(\", \")}:function(t){return[t.toLowerCase(),e[O][t].join(\", \")]})}_.prototype.entries=_.prototype[Symbol.iterator],Object.defineProperty(_.prototype,Symbol.toStringTag,{value:\"Headers\",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(_.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});const B=Symbol(\"internal\");function A(e,t){const o=Object.create(M);return o[B]={target:e,kind:t,index:0},o}const M=Object.setPrototypeOf({next(){if(!this||Object.getPrototypeOf(this)!==M)throw new TypeError(\"Value of `this` is not a HeadersIterator\");var e=this[B];const t=e.target,o=e.kind,n=e.index,r=E(t,o);return n>=r.length?{value:void 0,done:!0}:(this[B].index=n+1,{value:r[n],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));function R(e){const t=Object.assign({__proto__:null},e[O]),o=k(e[O],\"Host\");return void 0!==o&&(t[o]=t[o][0]),t}Object.defineProperty(M,Symbol.toStringTag,{value:\"HeadersIterator\",writable:!1,enumerable:!1,configurable:!0});const q=Symbol(\"Response internals\"),C=r.STATUS_CODES;class D{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};h.call(this,e,t);const o=t.status||200,n=new _(t.headers);if(null!=e&&!n.has(\"Content-Type\")){const t=x(e);t&&n.append(\"Content-Type\",t)}this[q]={url:t.url,status:o,statusText:t.statusText||C[o],headers:n,counter:t.counter}}get url(){return this[q].url||\"\"}get status(){return this[q].status}get ok(){return this[q].status>=200&&this[q].status<300}get redirected(){return this[q].counter>0}get statusText(){return this[q].statusText}get headers(){return this[q].headers}clone(){return new D(w(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected})}}h.mixIn(D.prototype),Object.defineProperties(D.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(D.prototype,Symbol.toStringTag,{value:\"Response\",writable:!1,enumerable:!1,configurable:!0});const L=Symbol(\"Request internals\"),U=s.parse,z=s.format,I=\"destroy\"in n.Readable.prototype;function V(e){return\"object\"==typeof e&&\"object\"==typeof e[L]}class H{constructor(e){let t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};V(e)?t=U(e.url):(t=e&&e.href?U(e.href):U(`${e}`),e={});let n=o.method||e.method||\"GET\";if(n=n.toUpperCase(),(null!=o.body||V(e)&&null!==e.body)&&(\"GET\"===n||\"HEAD\"===n))throw new TypeError(\"Request with GET/HEAD method cannot have body\");let r=null!=o.body?o.body:V(e)&&null!==e.body?w(e):null;h.call(this,r,{timeout:o.timeout||e.timeout||0,size:o.size||e.size||0});const s=new _(o.headers||e.headers||{});if(null!=r&&!s.has(\"Content-Type\")){const e=x(r);e&&s.append(\"Content-Type\",e)}let i=V(e)?e.signal:null;if(\"signal\"in o&&(i=o.signal),null!=i&&!function(e){const t=e&&\"object\"==typeof e&&Object.getPrototypeOf(e);return!(!t||\"AbortSignal\"!==t.constructor.name)}(i))throw new TypeError(\"Expected signal to be an instanceof AbortSignal\");this[L]={method:n,redirect:o.redirect||e.redirect||\"follow\",headers:s,parsedURL:t,signal:i},this.follow=void 0!==o.follow?o.follow:void 0!==e.follow?e.follow:20,this.compress=void 0!==o.compress?o.compress:void 0===e.compress||e.compress,this.counter=o.counter||e.counter||0,this.agent=o.agent||e.agent}get method(){return this[L].method}get url(){return z(this[L].parsedURL)}get headers(){return this[L].headers}get redirect(){return this[L].redirect}get signal(){return this[L].signal}clone(){return new H(this)}}function N(e){Error.call(this,e),this.type=\"aborted\",this.message=e,Error.captureStackTrace(this,this.constructor)}h.mixIn(H.prototype),Object.defineProperty(H.prototype,Symbol.toStringTag,{value:\"Request\",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(H.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}}),N.prototype=Object.create(Error.prototype),N.prototype.constructor=N,N.prototype.name=\"AbortError\";const F=n.PassThrough,G=s.resolve;function J(e,t){if(!J.Promise)throw new Error(\"native promise missing, set fetch.Promise to your favorite alternative\");return h.Promise=J.Promise,new J.Promise(function(o,s){const u=new H(e,t),c=function(e){const t=e[L].parsedURL,o=new _(e[L].headers);if(o.has(\"Accept\")||o.set(\"Accept\",\"*/*\"),!t.protocol||!t.hostname)throw new TypeError(\"Only absolute URLs are supported\");if(!/^https?:$/.test(t.protocol))throw new TypeError(\"Only HTTP(S) protocols are supported\");if(e.signal&&e.body instanceof n.Readable&&!I)throw new Error(\"Cancellation of streamed requests with AbortSignal is not supported in node < 8\");let r=null;if(null==e.body&&/^(POST|PUT)$/i.test(e.method)&&(r=\"0\"),null!=e.body){const t=S(e);\"number\"==typeof t&&(r=String(t))}r&&o.set(\"Content-Length\",r),o.has(\"User-Agent\")||o.set(\"User-Agent\",\"node-fetch/1.0 (+https://github.com/bitinn/node-fetch)\"),e.compress&&!o.has(\"Accept-Encoding\")&&o.set(\"Accept-Encoding\",\"gzip,deflate\");let s=e.agent;return\"function\"==typeof s&&(s=s(t)),o.has(\"Connection\")||s||o.set(\"Connection\",\"close\"),Object.assign({},t,{method:e.method,headers:R(o),agent:s})}(u),l=(\"https:\"===c.protocol?i:r).request,d=u.signal;let g=null;const p=function(){let e=new N(\"The user aborted a request.\");s(e),u.body&&u.body instanceof n.Readable&&u.body.destroy(e),g&&g.body&&g.body.emit(\"error\",e)};if(d&&d.aborted)return void p();const m=function(){p(),y()},h=l(c);let b;function y(){h.abort(),d&&d.removeEventListener(\"abort\",m),clearTimeout(b)}d&&d.addEventListener(\"abort\",m),u.timeout&&h.once(\"socket\",function(e){b=setTimeout(function(){s(new f(`network timeout at: ${u.url}`,\"request-timeout\")),y()},u.timeout)}),h.on(\"error\",function(e){s(new f(`request to ${u.url} failed, reason: ${e.message}`,\"system\",e)),y()}),h.on(\"response\",function(e){clearTimeout(b);const t=function(e){const t=new _;for(const o of Object.keys(e))if(!$.test(o))if(Array.isArray(e[o]))for(const n of e[o])P.test(n)||(void 0===t[O][o]?t[O][o]=[n]:t[O][o].push(n));else P.test(e[o])||(t[O][o]=[e[o]]);return t}(e.headers);if(J.isRedirect(e.statusCode)){const n=t.get(\"Location\"),r=null===n?null:G(u.url,n);switch(u.redirect){case\"error\":return s(new f(`redirect mode is set to error: ${u.url}`,\"no-redirect\")),void y();case\"manual\":if(null!==r)try{t.set(\"Location\",r)}catch(e){s(e)}break;case\"follow\":if(null===r)break;if(u.counter>=u.follow)return s(new f(`maximum redirect reached at: ${u.url}`,\"max-redirect\")),void y();const n={headers:new _(u.headers),follow:u.follow,counter:u.counter+1,agent:u.agent,compress:u.compress,method:u.method,body:u.body,signal:u.signal,timeout:u.timeout};return 303!==e.statusCode&&u.body&&null===S(u)?(s(new f(\"Cannot follow redirect with body being a readable stream\",\"unsupported-redirect\")),void y()):(303!==e.statusCode&&(301!==e.statusCode&&302!==e.statusCode||\"POST\"!==u.method)||(n.method=\"GET\",n.body=void 0,n.headers.delete(\"content-length\")),o(J(new H(r,n))),void y())}}e.once(\"end\",function(){d&&d.removeEventListener(\"abort\",m)});let n=e.pipe(new F);const r={url:u.url,status:e.statusCode,statusText:e.statusMessage,headers:t,size:u.size,timeout:u.timeout,counter:u.counter},i=t.get(\"Content-Encoding\");if(!u.compress||\"HEAD\"===u.method||null===i||204===e.statusCode||304===e.statusCode)return g=new D(n,r),void o(g);const c={flush:a.Z_SYNC_FLUSH,finishFlush:a.Z_SYNC_FLUSH};if(\"gzip\"==i||\"x-gzip\"==i)return n=n.pipe(a.createGunzip(c)),g=new D(n,r),void o(g);if(\"deflate\"!=i&&\"x-deflate\"!=i){if(\"br\"==i&&\"function\"==typeof a.createBrotliDecompress)return n=n.pipe(a.createBrotliDecompress()),g=new D(n,r),void o(g);g=new D(n,r),o(g)}else{e.pipe(new F).once(\"data\",function(e){n=8==(15&e[0])?n.pipe(a.createInflate()):n.pipe(a.createInflateRaw()),g=new D(n,r),o(g)})}}),function(e,t){const o=t.body;null===o?e.end():v(o)?o.stream().pipe(e):Buffer.isBuffer(o)?(e.write(o),e.end()):o.pipe(e)}(h,u)})}J.isRedirect=function(e){return 301===e||302===e||303===e||307===e||308===e},J.Promise=global.Promise,t.default=J},function(e,t,o){\"use strict\";o.r(t);var n={};o.r(n),o.d(n,\"MsgSend\",function(){return p}),o.d(n,\"MsgDelegate\",function(){return m}),o.d(n,\"MsgUndelegate\",function(){return h}),o.d(n,\"MsgRedelegate\",function(){return b}),o.d(n,\"MsgSubmitProposal\",function(){return y}),o.d(n,\"MsgVote\",function(){return v}),o.d(n,\"MsgDeposit\",function(){return w}),o.d(n,\"MsgWithdrawDelegationReward\",function(){return x}),o.d(n,\"default\",function(){return $});var r=o(1),s=o.n(r);const i=4;function a(e,{sequence:t,accountNumber:o,chainId:n}){var r=e.value;const s={amount:r.fee.amount||[],gas:r.fee.gas};return JSON.stringify(u({fee:s,memo:r.memo,msgs:r.msg,sequence:t,account_number:o,chain_id:n}))}function u(e){if(Array.isArray(e))return e.map(u);if(\"object\"!=typeof e)return e;const t={};return Object.keys(e).sort().forEach(o=>{void 0!==e[o]&&null!==e[o]&&(t[o]=u(e[o]))}),t}const c=[{amount:2.5e-8.toFixed(9),denom:\"uatom\"}];async function l({gas:e,gasPrices:t=c,memo:o=\"\"},n,r,i,a,u,l){var g=function(e,t=\"sync\"){return JSON.stringify({tx:e,mode:t})}(await d({gas:e,gasPrices:t,memo:o},n,r,a,u,l),\"block\");console.log(\"body\"),console.log(g);const p=await s()(`${i}/txs`,{method:\"POST\",body:g,headers:{\"Content-Type\":\"application/json\"}});console.log(\"***************\"),console.log(\"状态代码\",p.status);var m=await p.json();return f(m),console.log(m),console.log(\"***************\"),{hash:m.txhash,sequence:l,included:()=>(async function(e,t,o=60,n=3e3){let r;for(;o-- >0;)try{r=await s()(`${t}/txs/${e}`).then(function(e){if(e.status>=200&&e.status<300)return Promise.resolve(e.json());var t=new Error(e.statusText||e.status);return t.response=e,Promise.reject(t)});break}catch(e){await new Promise(e=>setTimeout(e,n))}if(o<=0)throw new Error(\"The transaction was still not included in a block. We can't say for certain it will be included in the future.\");return f(r),r})(m.txhash,i)}}async function d({gas:e,gasPrices:t=c,memo:o=\"\"},n,r,s,i,u){console.log(\"createSignedTransaction\"),console.log(n),console.log(r);const l=function({gas:e,gasPrices:t,memo:o},n){const r=t.map(({amount:t,denom:o})=>({amount:String(Math.round(t*e)),denom:o})).filter(({amount:e})=>e>0);return{type:\"cosmos-sdk/StdTx\",value:{msg:Array.isArray(n)?n:[n],fee:{amount:r.length>0?r:[],gas:e},signatures:null,memo:o}}}({gas:e,gasPrices:t,memo:o},n),d=a(l,{sequence:u,accountNumber:i,chainId:s});let f,g;console.log(d),console.log(\"createSignedTransaction\");try{({signature:f,publicKey:g}=await r(d))}catch(e){throw new Error(\"Signing failed: \"+e.message)}console.log(\"after signer\"),console.log(f),console.log(g);const p=function(e,t){return e.value.signatures=[t],console.log(\"createSignedTransactionObject\"),console.log(e),e}(l,function(e,t,o,n){return{signature:e.toString(\"base64\"),account_number:o,sequence:t,pub_key:{type:\"tendermint/PubKeySecp256k1\",value:n.toString(\"base64\")}}}(f,u,i,g));return console.log(p),p}function f(e){if(console.log(\"assertOk\"),console.log(e),console.log(\"assertOk\"),Array.isArray(e)){if(0===e.length)throw new Error(\"Error sending transaction\");e.forEach(f)}if(e.error)throw new Error(e.error);if(e.code){const t=JSON.parse(e.raw_log).message;throw new Error(t)}if(!e.txhash){const t=e.message;throw new Error(t)}return e}const g=1.5;function p(e,{toAddress:t,amounts:o}){return{type:\"cosmos-sdk/MsgSend\",value:{from_address:e,to_address:t,amount:o.map(S)}}}function m(e,{validatorAddress:t,amount:o,denom:n}){return{type:\"cosmos-sdk/MsgDelegate\",value:{delegator_address:e,validator_address:t,amount:S({amount:o,denom:n})}}}function h(e,{validatorAddress:t,amount:o,denom:n}){return{type:\"cosmos-sdk/MsgUndelegate\",value:{validator_address:t,delegator_address:e,amount:S({amount:o,denom:n})}}}function b(e,{validatorSourceAddress:t,validatorDestinationAddress:o,amount:n,denom:r}){return{type:\"cosmos-sdk/MsgBeginRedelegate\",value:{delegator_address:e,validator_src_address:t,validator_dst_address:o,amount:S({amount:n,denom:r})}}}function y(e,{proposalType:t,title:o,description:n,initialDeposits:r}){return{type:\"cosmos-sdk/MsgSubmitProposal\",value:{proposer:e,proposal_type:t,title:o,description:n,initial_deposit:r.map(S)}}}function v(e,{proposalId:t,option:o}){return{type:\"cosmos-sdk/MsgVote\",value:{voter:e,proposal_id:t,option:o}}}function w(e,{proposalId:t,amounts:o}){return{type:\"cosmos-sdk/MsgDeposit\",value:{depositor:e,proposal_id:t,amount:o.map(S)}}}function x(e,{validatorAddress:t}){return{type:\"cosmos-sdk/MsgWithdrawDelegationReward\",value:{delegator_address:e,validator_address:t}}}function S({amount:e,denom:t}){return{amount:String(e),denom:t}}var $={MsgSend:p,MsgDelegate:m,MsgUndelegate:h,MsgRedelegate:b,MsgSubmitProposal:y,MsgVote:v,MsgDeposit:w,MsgWithdrawDelegationReward:x};o.d(t,\"default\",function(){return P}),o.d(t,\"createSignedTransaction\",function(){return d}),o.d(t,\"createSignMessage\",function(){return a});class P{constructor(e,t){this.url=e,this.get={},this.accounts={},this.chainId=t;const o=function(e){function t(t,o=i){for(;o;)try{return console.log(e+t),s()(e+t).then(e=>e.json())}catch(e){if(0==--o)throw e}}return{url:e,connected:function(){return this.nodeVersion().then(()=>!0,()=>!1)},nodeVersion:()=>s()(e+\"/node_version\").then(e=>e.text()),account:function(e){const o={coins:[],sequence:\"0\",account_number:\"0\"};return t(`/auth/accounts/${e}`).then(e=>{console.log(e);let t=e.value||o;if(\"auth/DelayedVestingAccount\"===e.type){if(!t.BaseVestingAccount)return console.error(\"SDK format of vesting accounts responses has changed\"),o;delete(t=Object.assign({},t.BaseVestingAccount.BaseAccount,t.BaseVestingAccount)).BaseAccount,delete t.BaseVestingAccount}return console.log(t),t}).catch(e=>{if(e.response&&(e.response.data.includes(\"account bytes are empty\")||e.response.data.includes(\"failed to prove merkle proof\")))return o;throw e})},txs:function(e){return Promise.all([this.bankTxs(e),this.governanceTxs(e),this.distributionTxs(e),this.stakingTxs(e)]).then(e=>[].concat(...e))},bankTxs:function(e){return console.log(\"*****************\"),console.log(`/txs?message.action=send&message.sender=${e}`),console.log(`/txs?transfer.recipient=${e}`),console.log(\"*****************\"),Promise.all([t(`/txs?message.action=send&message.sender=${e}`),t(`/txs?transfer.recipient=${e}`)]).then(([e,t])=>[].concat(e,t))},txsByHeight:function(e){return t(`/txs?tx.height=${e}`)},tx:e=>t(`/txs/${e}`),stakingTxs:async function(e,o){return Promise.all([t(`/txs?action=create_validator&destination-validator=${o}`),t(`/txs?action=edit_validator&destination-validator=${o}`),t(`/txs?action=delegate&delegator=${e}`),t(`/txs?action=begin_redelegate&delegator=${e}`),t(`/txs?action=begin_unbonding&delegator=${e}`),t(`/txs?action=unjail&source-validator=${o}`)]).then(([e,t,o,n,r,s])=>[].concat(e,t,o,n,r,s))},delegations:function(e){return console.log(`/staking/delegators/${e}/delegations`),t(`/staking/delegators/${e}/delegations`)},undelegations:function(e){return t(`/staking/delegators/${e}/unbonding_delegations`,!0)},redelegations:function(e){return t(`/staking/redelegations?delegator=${e}`)},delegatorValidators:function(e){return t(`/staking/delegators/${e}/validators`)},validators:()=>Promise.all([t(\"/staking/validators?status=unbonding\"),t(\"/staking/validators?status=bonded\"),t(\"/staking/validators?status=unbonded\")]).then(e=>[].concat(...e)),validator:function(e){return t(`/staking/validators/${e}`)},validatorSet:()=>t(\"/validatorsets/latest\"),delegation:function(e,o){return t(`/staking/delegators/${e}/delegations/${o}`,!0)},unbondingDelegation:function(e,o){return t(`/staking/delegators/${e}/unbonding_delegations/${o}`,!0)},pool:()=>t(\"/staking/pool\"),stakingParameters:()=>t(\"/staking/parameters\"),validatorSigningInfo:function(e){return t(`/slashing/validators/${e}/signing_info`)},proposals:()=>t(\"/gov/proposals\"),proposal:function(e){return t(`/gov/proposals/${e}`)},proposalVotes:function(e){return t(`/gov/proposals/${e}/votes`)},proposalVote:function(e,o){return t(`/gov/proposals/${e}/votes/${o}`)},proposalDeposits:function(e){return t(`/gov/proposals/${e}/deposits`)},proposalDeposit:function(e,o){return t(`/gov/proposals/${e}/deposits/${o}`,!0)},proposalTally:function(e){return t(`/gov/proposals/${e}/tally`)},govDepositParameters:()=>t(\"/gov/parameters/deposit\"),govTallyingParameters:()=>t(\"/gov/parameters/tallying\"),govVotingParameters:()=>t(\"/gov/parameters/voting\"),governanceTxs:async function(e){return Promise.all([t(`/txs?action=submit_proposal&proposer=${e}`),t(`/txs?action=deposit&depositor=${e}`),t(`/txs?action=vote&voter=${e}`)]).then(([e,t,o])=>[].concat(e,t,o))},block:function(e){return t(`/blocks/${e}`)},distributionTxs:async function(e,o){return Promise.all([t(`/txs?action=set_withdraw_address&delegator=${e}`),t(`/txs?action=withdraw_delegator_reward&delegator=${e}`),t(`/txs?action=withdraw_validator_rewards_all&source-validator=${o}`)]).then(([e,t,o])=>[].concat(e,t,o))},delegatorRewards:function(e){return t(`/distribution/delegators/${e}/rewards`)},delegatorRewardsFromValidator:function(e,o){return t(`/distribution/delegators/${e}/rewards/${o}`)},validatorDistributionInformation:function(e){return t(`/distribution/validators/${e}`)},validatorRewards:function(e){return t(`/distribution/validators/${e}/rewards`)},distributionParameters:function(){return t(\"/distribution/parameters\")},distributionOutstandingRewards:function(){return t(\"/distribution/outstanding_rewards\")}}}(e);Object.keys(o).forEach(e=>{this.get[e]=o[e]}),Object.entries(n).forEach(([e,t])=>{this[e]=function(e,o){const n=t(e,o);return{message:n,simulate:({memo:t})=>this.simulate(e,{message:n,memo:t}),send:({gas:t,gasPrices:o,memo:r},s)=>this.send(e,{gas:t,gasPrices:o,memo:r},n,s)}}}),this.MultiMessage=function(e,...t){const o=[].concat(...t).map(({message:e})=>e);return{messages:o,simulate:({memo:t})=>this.simulate(e,{message:o[0],memo:t}),send:({gas:t,gasPrices:n,memo:r},s)=>this.send(e,{gas:t,gasPrices:n,memo:r},o,s)}}}async setChainId(e=this.chainId){if(!e){const{block_meta:{header:{chain_id:e}}}=await this.get.block(\"latest\")}return this.chainId=e,e}async getAccount(e){const{sequence:t,account_number:o}=await this.get.account(e);return this.accounts[e]={sequence:this.accounts[e]&&t<this.accounts[e].sequence?this.accounts[e].sequence:t,accountNumber:o},this.accounts[e]}async send(e,{gas:t,gasPrices:o,memo:n},r,s){const i=await this.setChainId(),{sequence:a,accountNumber:u}=await this.getAccount(e),{hash:c,included:d}=await l({gas:t,gasPrices:o,memo:n},r,s,this.url,i,u,a);return this.accounts[e].sequence+=1,{hash:c,sequence:a,included:d}}async simulate(e,{message:t,memo:o}){const n=await this.setChainId(),{sequence:r,accountNumber:i}=await this.getAccount(e);return async function(e,t,o,n,r,i,a){const u=`${e}${{\"cosmos-sdk/MsgSend\":()=>`/bank/accounts/${t}/transfers`,\"cosmos-sdk/MsgDelegate\":()=>`/staking/delegators/${t}/delegations`,\"cosmos-sdk/MsgUndelegate\":()=>`/staking/delegators/${t}/unbonding_delegations`,\"cosmos-sdk/MsgBeginRedelegate\":()=>`/staking/delegators/${t}/redelegations`,\"cosmos-sdk/MsgSubmitProposal\":()=>\"/gov/proposals\",\"cosmos-sdk/MsgVote\":()=>`/gov/proposals/${n.value.proposal_id}/votes`,\"cosmos-sdk/MsgDeposit\":()=>`/gov/proposals/${n.value.proposal_id}/deposits`,\"cosmos-sdk/MsgWithdrawDelegationReward\":()=>`/distribution/delegators/${t}/rewards`}[n.type]()}`,c=function(e,t,{sequence:o,accountNumber:n,memo:r},s){return{base_req:{sequence:o,from:e,account_number:n,chain_id:t,simulate:!0,memo:r},...s.value}}(t,o,{sequence:i,accountNumber:a,memo:r},n),{gas_estimate:l}=await s()(u,{method:\"POST\",body:JSON.stringify(c)}).then(e=>e.json());return Math.round(l*g)}(this.url,e,n,t,o,r,i)}}}])});"],"mappings":"AAAA","sourceRoot":""}